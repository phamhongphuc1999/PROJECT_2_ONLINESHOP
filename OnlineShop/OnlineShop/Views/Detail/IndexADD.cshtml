@model OnlineShop.Models.DetailModel

@{
    ViewBag.Title = "Phiếu thu";
}

<h2>Phiếu thu của khách hàng</h2>
<script>
    if (@ViewBag.Flag == 0)
    {
        debugger
         alert("Trong kho không đủ hàng");
    }
</script>
@using (Html.BeginForm("CREATEADD", "Detail"))
{
    @Html.AntiForgeryToken()
    <div class="form-horizontal">
        <h4>Chi tiết</h4><hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            @Html.Label("MAHD", "Mã Hóa Đơn", new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.IdInvoice, new { htmlAttributes = new { @class = "form-control", id = "id-invoice" } })
                <script>
                    var ob = document.getElementById("id-invoice");
                    ob.value = @ViewBag.MAHD;
                </script>
                @Html.ValidationMessageFor(model => model.IdInvoice, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("Mã sản phẩm-Mã lô", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.TextBoxFor(model => model.ID, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.ID, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.Label("SOLUONG", "Số lượng", htmlAttributes: new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Amount, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Amount, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Create" class="btn btn-default" />
            </div>
        </div>
    </div>
    <table class="table">
        <tr>
            <th>Mã Hóa Đơn</th>
            <th>Số lượng</th>
            <th>Mã sản phẩm</th>
            <th>Đơn giá</th>
            <th>Thành tiền</th>
            <th>Ngày bán</th>
        </tr>
        @{
            var s = 0;
        }
        @foreach (var item in ViewBag.Model)
        {
            <tr>
                <td>@item.IdInvoice</td>
                <td>@item.Amount</td>
                <td>@item.IdProduct</td>
                <td>@item.ExportPrice</td>
                <td>@item.Money</td>
                <td>@item.DaySell.ToString("dd/MM/yyyy")</td>
                <td>
                    @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                    @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                    @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                </td>
            </tr>
            { s = s + (int)(item.Money); }
        }
        <tr>
            <td></td>
            <td></td>
            <td>Tổng tiền</td>
            <td>@s VND</td>
            <td>@Html.ActionLink("Done", "Create", "Invoice")</td>
        </tr>
    </table>
    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
}
